#replaces water bottle with toxic
execute as @a[nbt={SelectedItem:{id:"minecraft:potion",tag:{Potion:"minecraft:water"}}}] at @s unless entity @s[nbt={SelectedItem:{id:"minecraft:potion",tag:{Purified:0b}}}] unless entity @s[nbt={SelectedItem:{id:"minecraft:potion",tag:{Purified:1b}}}] run replaceitem entity @s weapon.mainhand minecraft:potion{Potion:"minecraft:water",Purified:0b,display:{Name:'{"text":"Toxic Water Bottle","italic":"false"}',Lore:['{"text":"Leaves a disgusting taste in your mouth","color":"gray","italic":"false"}']},CustomPotionColor:2582586,HideFlags:127}

#prehardmode purifying
execute unless score Target Hardmode matches 1 as @e[type=minecraft:item,nbt={Item:{id:"minecraft:blaze_powder",Count:1b}}] at @s if block ~ ~ ~ minecraft:cauldron[level=3] if block ~ ~-1 ~ minecraft:fire if entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:glass_bottle",Count:1b}},distance=..1] unless entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:nether_star",Count:1b}},distance=..1] run tag @s add purifying

execute unless score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run fill ~ ~ ~ ~ ~ ~ minecraft:cauldron[level=0] replace minecraft:cauldron[level=3]
execute unless score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run data merge entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:glass_bottle",Count:1b}},distance=..1,limit=1] {Item:{id:"minecraft:potion",Count:1b,tag:{HideFlags:127,CustomPotionColor:2659819,Potion:"minecraft:purified",Purified:1b,display:{Name:'{"text":"Purified Water Bottle","italic":"false"}',Lore:['{"text":"Light and refreshing","color":"gray","italic":"false"}']}}},PickupDelay:0s}
execute unless score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run kill @s


#hardmode purifying
execute if score Target Hardmode matches 1 as @e[type=minecraft:item,nbt={Item:{id:"minecraft:blaze_powder",Count:1b}}] at @s if block ~ ~ ~ minecraft:cauldron[level=3] if block ~ ~-1 ~ minecraft:fire if entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:glass_bottle",Count:1b}},distance=..1] if entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:magma_cream",Count:1b}},distance=..1] if entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:chorus_fruit",Count:1b}},distance=..1] unless entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:nether_star",Count:1b}},distance=..1] run tag @s add purifying

execute if score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run fill ~ ~ ~ ~ ~ ~ minecraft:cauldron[level=0] replace minecraft:cauldron[level=3]
execute if score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run data merge entity @e[type=minecraft:item,nbt={Item:{id:"minecraft:glass_bottle",Count:1b}},distance=..1,limit=1] {Item:{id:"minecraft:potion",Count:1b,tag:{HideFlags:127,CustomPotionColor:2659819,Potion:"minecraft:purified",Purified:1b,display:{Name:'{"text":"Purified Water Bottle","italic":"false"}',Lore:['{"text":"Light and refreshing","color":"gray","italic":"false"}']}}},PickupDelay:0s}
execute if score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run kill @e[type=minecraft:item,nbt={Item:{id:"minecraft:magma_cream",Count:1b}},distance=..2]
execute if score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run kill @e[type=minecraft:item,nbt={Item:{id:"minecraft:chorus_fruit",Count:1b}},distance=..2]
execute if score Target Hardmode matches 1 as @e[type=minecraft:item,tag=purifying] at @s run kill @s